<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DNR Adressensuche</title>

<style>
body {
  font-family: Arial, sans-serif;
  background-color: #f9f9f9;
  padding: 20px;
}

h2 {
  text-align: center;
}

input {
  display: block;
  margin: 0 auto;
  padding: 12px;
  font-size: 18px;
  width: 90%;
  max-width: 300px;
  border: 2px solid #999;
  border-radius: 6px;
}

.legend {
  max-width: 600px;
  margin: 15px auto;
  display: flex;
  justify-content: space-around;
  font-weight: bold;
}

.legend span {
  padding: 6px 12px;
  border: 2px solid #333;
}

.low { background: #ffffff; }
.mid { background: #ffcc66; }
.high { background: #e06666; }

p#noResults {
  text-align: center;
  color: #b30000;
  font-weight: bold;
}

table {
  border-collapse: collapse;
  width: 100%;
  max-width: 600px;
  margin: 20px auto;
  background-color: #fff;
}

th, td {
  border: 2px solid #444; /* lignes plus Ã©paisses */
  padding: 10px;
  white-space: nowrap;
}

th {
  background-color: #003f7f;
  color: #fff;
}

.orange {
  background-color: #ffcc66;
}

.red {
  background-color: #e06666;
}
</style>
</head>

<body>

<h2>DNR Adressensuche</h2>

<input type="text" id="plzInput" placeholder="PLZ eingeben / enter ZIP">

<div class="legend">
  <span class="low">White â€“ Low risk</span>
  <span class="mid">Orange â€“ Middle risk</span>
  <span class="high">Red â€“ High risk</span>
</div>

<p id="noResults"></p>

<table>
  <thead>
    <tr>
      <th>StraÃŸe</th>
      <th>Ort</th>
      <th>PLZ</th>
    </tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<script>
fetch("DNR_Adressen.csv")
  .then(res => res.text())
  .then(text => {

    const rows = text.trim().split("\n").slice(1);
    const map = {};

    rows.forEach(r => {
      const [street, city, zip] = r.split(";").map(c => c.trim());
      const key = `${street}|${city}|${zip}`;

      if (!map[key]) {
        map[key] = { street, city, zip, count: 1 };
      } else {
        map[key].count++;
      }
    });

    const data = Object.values(map);
    const tbody = document.getElementById("tableBody");
    const msg = document.getElementById("noResults");

    document.getElementById("plzInput").addEventListener("input", function () {
      const plz = this.value.replace(/\D/g, "");
      tbody.innerHTML = "";
      let found = false;

      data.forEach(addr => {
        if (addr.zip.replace(/\D/g, "") === plz) {
          let cls = "";
          if (addr.count >= 2 && addr.count <= 3) cls = "orange";
          if (addr.count > 3) cls = "red";

          tbody.innerHTML += `
            <tr class="${cls}">
              <td>${addr.street}</td>
              <td>${addr.city}</td>
              <td>${addr.zip}</td>
            </tr>
          `;
          found = true;
        }
      });

      msg.textContent = found ? "" : "Keine Adresse gefunden / No address found, area safe ðŸ™‚";
    });
  });
</script>

</body>
</html>
